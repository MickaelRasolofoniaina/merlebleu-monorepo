<div class="card">
  <div class="flex justify-between items-center mb-4">
    <h2 class="text-2xl font-bold">Méthode de paiement</h2>
  </div>
  <div class="flex justify-end mb-4">
    <p-button label="Ajouter" icon="pi pi-plus" (onClick)="addPaymentMethod()" />
  </div>

  <p-table
    [value]="paymentMethods"
    [loading]="isLoadingPayments"
    [tableStyle]="{ 'min-width': '50rem' }"
    [stripedRows]="true"
  >
    <ng-template #header>
      <tr>
        <th>Nom</th>
        <th style="width: 10rem">Actions</th>
      </tr>
    </ng-template>
    <ng-template #body let-payment>
      <tr>
        <td>{{ payment.name }}</td>
        <td>
          <p-button
            icon="pi pi-pencil"
            [rounded]="true"
            [outlined]="true"
            severity="secondary"
            class="mr-2"
            (onClick)="editPaymentMethod(payment.id, payment.name)"
          />
          <p-button
            icon="pi pi-trash"
            [rounded]="true"
            [outlined]="true"
            severity="danger"
            (onClick)="deletePaymentMethod(payment.id, payment.name)"
          />
        </td>
      </tr>
    </ng-template>
  </p-table>

  <p-dialog
    [(visible)]="displayModal"
    [modal]="true"
    [style]="{ width: '450px' }"
    header="Ajouter une méthode de paiement"
  >
    <div class="flex flex-col gap-4">
      <div>
        <label for="paymentMethodName" class="block mb-2">Nom</label>
        <input
          id="paymentMethodName"
          type="text"
          pInputText
          [(ngModel)]="newPaymentMethodName"
          class="w-full"
          placeholder="Entrez le nom de la méthode de paiement"
        />
        @if (validationError) {
          <small class="text-red-500 mt-1 block">{{ validationError }}</small>
        }
      </div>
    </div>

    <ng-template pTemplate="footer">
      <div class="flex justify-end gap-2">
        <p-button label="Annuler" severity="danger" (onClick)="cancelAddPaymentMethod()" />
        <p-button label="Confirmer" (onClick)="confirmAddPaymentMethod()" />
      </div>
    </ng-template>
  </p-dialog>

  <p-dialog
    [(visible)]="displayEditModal"
    [modal]="true"
    [style]="{ width: '450px' }"
    header="Modifier une méthode de paiement"
  >
    <div class="flex flex-col gap-4">
      <div>
        <label for="editPaymentMethodName" class="block mb-2">Nom</label>
        <input
          id="editPaymentMethodName"
          type="text"
          pInputText
          [(ngModel)]="editPaymentMethodName"
          class="w-full"
          placeholder="Entrez le nom de la méthode de paiement"
        />
        @if (editValidationError) {
          <small class="text-red-500 mt-1 block">{{ editValidationError }}</small>
        }
      </div>
    </div>

    <ng-template pTemplate="footer">
      <div class="flex justify-end gap-2">
        <p-button label="Annuler" severity="danger" (onClick)="cancelEditPaymentMethod()" />
        <p-button label="Modifier" (onClick)="confirmUpdatePaymentMethod()" />
      </div>
    </ng-template>
  </p-dialog>

  <p-dialog
    [(visible)]="displayDeleteModal"
    [modal]="true"
    [style]="{ width: '450px' }"
    header="Confirmer la suppression"
  >
    <div class="flex flex-col gap-4">
      <p>
        Voulez-vous vraiment supprimer la méthode de paiement
        <strong>{{ deletePaymentMethodName }}</strong> ?
      </p>
    </div>

    <ng-template pTemplate="footer">
      <div class="flex justify-end gap-2">
        <p-button label="Annuler" severity="secondary" (onClick)="cancelDeletePaymentMethod()" />
        <p-button label="Supprimer" severity="danger" (onClick)="confirmDeletePaymentMethod()" />
      </div>
    </ng-template>
  </p-dialog>
</div>
